{% extends 'base.html' %}

{% block content %}
<div class="animate-fade-in">
    <a href="{{ url_for('game_dashboard', game_id=game.id) }}"
        style="color: var(--primary-color); text-decoration: none; margin-bottom: 1rem; display: block;">&larr; Abort
        Round</a>
    <h1>Active Round - {{ game.name }}</h1>
    <p style="color: var(--text-muted); margin-bottom: 2rem;">Moderator: Enter bets for each team and select the correct
        option.</p>
</div>

<form action="{{ url_for('submit_round', game_id=game.id, round_id=round_obj.id) }}" method="POST">
    <div class="glass-card animate-fade-in" style="animation-delay: 0.1s;">
        <h2>Team Bets</h2>
        <div style="display: grid; gap: 1rem;">
            {% for team in teams %}
            <div class="glass-card" style="margin-bottom: 0px; padding: 1.5rem; background: rgba(255,255,255,0.03);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <span style="font-weight: bold; font-size: 1.2rem;">{{ team.name }}</span>
                    <span style="color: var(--accent-color);">Balance: ${{ "%.2f"|format(team.money) }}</span>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <div style="flex: 2; min-width: 200px;">
                        <label style="font-size: 0.8rem; color: var(--text-muted);">Amount</label>
                        <input type="number" name="bet_{{ team.id }}" step="0.01" max="{{ team.money }}"
                            placeholder="Bet Amount">
                    </div>
                    <div style="flex: 1.5; min-width: 200px;">
                        <label style="font-size: 0.8rem; color: var(--text-muted);">Option Choice</label>
                        <select name="option_{{ team.id }}"
                            style="width: 100%; padding: 0.75rem 1rem; border-radius: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.1); background: rgba(0, 0, 0, 0.2); color: white; outline: none;">
                            <option value="0">No Bet</option>
                            <option value="1">1: {{ round_obj.opt1 }}</option>
                            <option value="2">2: {{ round_obj.opt2 }}</option>
                            <option value="3">3: {{ round_obj.opt3 }}</option>
                            <option value="4">4: {{ round_obj.opt4 }}</option>
                            <option value="5">5: {{ round_obj.opt5 }}</option>
                        </select>
                    </div>
                    <div style="flex: 0.5; display: flex; align-items: flex-end; padding-bottom: 10px;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" name="all_in_{{ team.id }}" style="width: 20px; height: 20px;">
                            <span>All-In</span>
                        </label>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="glass-card animate-fade-in" style="animation-delay: 0.2s;">
        <h2>Correct Option</h2>
        <p style="color: var(--text-muted); margin-bottom: 1rem;">Select WHICH option was actually correct:</p>
        <div style="display: grid; gap: 0.5rem;">
            {% for i in range(1, 6) %}
            <label class="btn"
                style="text-align: left; border: 1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.2); cursor: pointer; display: flex; align-items: center; gap: 1rem; padding: 1rem;">
                <input type="radio" name="correct_option" value="{{ i }}" required style="width: 20px; height: 20px;">
                <span>{{ i }}: {% if i==1 %}{{ round_obj.opt1 }}{% elif i==2 %}{{ round_obj.opt2 }}{% elif i==3 %}{{
                    round_obj.opt3 }}{% elif i==4 %}{{ round_obj.opt4 }}{% else %}{{ round_obj.opt5 }}{% endif %}</span>
            </label>
            {% endfor %}
        </div>
    </div>

    <div class="animate-fade-in" style="animation-delay: 0.3s;">
        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 1.5rem; font-size: 1.2rem;">Calculate
            Payouts</button>
    </div>
</form>

<style>
    input[type="radio"]:checked+span {
        color: var(--primary-color);
        font-weight: bold;
    }

    label:has(input[type="radio"]:checked) {
        border-color: var(--primary-color) !important;
        background: rgba(99, 102, 241, 0.1) !important;
    }
</style>
{% endblock %}