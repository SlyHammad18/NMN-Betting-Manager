{% extends 'base.html' %}

{% block content %}
<div class="animate-fade-in text-center">
    <h1>Round Results</h1>
    <h2 style="color: var(--primary-color);">Correct Option: {{ correct_option }} -
        {% if correct_option==1 %}{{ round_obj.opt1 }}{% elif correct_option==2 %}{{ round_obj.opt2 }}{% elif
        correct_option==3 %}{{ round_obj.opt3 }}{% elif correct_option==4 %}{{ round_obj.opt4 }}{% else %}{{
        round_obj.opt5 }}{% endif %}
    </h2>
    <p style="color: var(--text-muted); margin-bottom: 2rem;">Payouts have been calculated and applied.</p>
</div>

<div class="glass-card animate-fade-in" style="animation-delay: 0.1s;">
    <h2>Payout Details</h2>
    <div style="display: grid; gap: 1rem;">
        {% for res in results %}
        {% set team = game.teams|selectattr('id', 'equalto', res.team_id)|first %}
        <div class="glass-card"
            style="margin-bottom: 0px; padding: 1rem; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid {{ 'var(--accent-color)' if res.is_winner else 'var(--error-color)' }};">
            <div>
                <span style="font-weight: bold;">{{ team.name }}</span>
                {% if res.is_winner %}
                <span class="badge badge-active" style="margin-left: 0.5rem;">Winner</span>
                {% endif %}
            </div>
            <div style="text-align: right;">
                <div
                    style="font-weight: bold; font-size: 1.2rem; color: {{ 'var(--accent-color)' if res.payout > 0 else 'var(--text-muted)' }}">
                    +${{ "%.2f"|format(res.payout) }}
                </div>
                <div style="font-size: 0.8rem; color: var(--text-muted);">
                    New Balance: ${{ "%.2f"|format(team.money) }}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<div class="glass-card animate-fade-in" style="animation-delay: 0.2s;">
    <h3>Carryover to Next Round</h3>
    <div style="font-size: 2rem; font-weight: bold; color: var(--secondary-color);">
        ${{ "%.2f"|format(next_carryover) }}
    </div>
    <p style="color: var(--text-muted);">This amount will be added to the winner's pool in the next round.</p>
</div>

<div class="animate-fade-in" style="animation-delay: 0.3s; display: flex; gap: 1rem;">
    <a href="{{ url_for('game_dashboard', game_id=game.id) }}" class="btn btn-primary"
        style="flex: 1; text-align: center;">Continue to Dashboard</a>
</div>
{% endblock %}